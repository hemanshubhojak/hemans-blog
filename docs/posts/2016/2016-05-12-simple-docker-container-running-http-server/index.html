<!DOCTYPE html>
<html>

<head>
    
    

    <title>heman's blog</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600&family=Roboto+Mono:wght@300;400;600"
        rel="stylesheet" />
    <link rel="stylesheet" href="https://hemans.blog/syntax.a832bd16b1d6afac69b94ca616a61d04b6ac9ffe41dd90333d406c1ebed2eddc.css" integrity="sha256-qDK9FrHWr6xpuUymFqYdBLasn/5B3ZAzPUBsHr7S7dw="
        media="screen">
    <link rel="stylesheet" href="https://hemans.blog/main.min.71aa65299931f19f62c8f84bcd6e1d1816d76d812742550ee1f608dc2cc30e42.css" integrity="sha256-caplKZkx8Z9iyPhLzW4dGBbXbYEnQlUO4fYI3CzDDkI=" media="screen">
</head>

<body>

    <div class="container">
        
<header class="site-header">
    <h2>
        <a href="https://hemans.blog/">heman's blog</a>
    </h2>
</header>


        <main>
            
<article>
    <header>
        <h1>
            Simple Docker container running a http server
        </h1>
        <small>
            May 12, 2016 &middot; 3 minute read
        </small>
    </header>
    <div>
        <p>In this exercise we will create a Docker container which will run a simple http server.</p>
<p>Before starting, setup Docker on your local machine. You can easily <a href="/2016/05/11/settingup-docker-windows-chocolatey.html">setup Docker on your Windows machine using Chocolatey</a>.</p>
<h3 id="creating-a-dockerfile">Creating a Dockerfile</h3><p>We will create the Docker container using a <code>Dockerfile</code>. A Dockerfile contains a set of instructions to tell docker how to create and configure the container.</p>
<p>Create a directory with the name <code>docker-playground</code>.</p>
<p>Inside this directory, create a file name <code>Dockerfile</code> without extension.</p>
<p>Add the following line to the file.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">FROM ubuntu:latest
</code></pre></div><p>This tells Docker that we want to create a new image using <code>ubuntu:latest</code> as the base image. Here <code>ubuntu</code> is the name of a repository and <code>latest</code> is a tag. This should be the first line in the file.</p>
<p>Optionally we can specify the name and email of the maintainer.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">MAINTAINER Hemanshu Bhojak &lt;hemanshubhojak@example.com&gt;
</code></pre></div><p>Now we will update <code>apt-get</code> and use it to install <code>nodejs</code> and <code>npm</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">RUN apt-get update
RUN apt-get install -y nodejs
RUN apt-get install -y npm
</code></pre></div><p><code>http-server</code> is a simple, zero-configuration command-line http server. It serves files from the current directory over http. We can install it using <code>npm</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">RUN npm install -g http-server
</code></pre></div><p>Create a symlink to the <code>nodejs</code> directory so that it can be run using the <code>node</code> command.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">RUN ln -s /usr/bin/nodejs /usr/bin/node
</code></pre></div><p>Create a html file with some content in the <code>docker-playground</code> directory and name it index.html. We will add this file to the container.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">ADD index.html /usr/apps/hello-docker/index.html
</code></pre></div><p>Now we will set the working directory of the container to this path.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">WORKDIR /usr/apps/hello-docker/
</code></pre></div><p>Lastly we will specify a command to run the http-server in silent mode by specifying the <code>-s</code> option.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">CMD [&#34;http-server&#34;, &#34;-s&#34;] 
</code></pre></div><p>Your Dockerfile should look like this.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">FROM ubuntu:latest
MAINTAINER Hemanshu Bhojak &lt;hemanshubhojak@example.com&gt;

RUN apt-get update
RUN apt-get install -y nodejs
RUN apt-get install -y npm
RUN ln -s /usr/bin/nodejs /usr/bin/node

RUN npm install -g http-server

ADD index.html /usr/apps/hello-docker/index.html
WORKDIR /usr/apps/hello-docker/

CMD [&#34;http-server&#34;, &#34;-s&#34;]
</code></pre></div><h3 id="build-the-dockerfile">Build the Dockerfile</h3><p>Run the following command in your <code>docker-playground</code> directory.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">docker build -t &#34;playground:hello-docker&#34; .
</code></pre></div><p>This command builds a container image in the <code>playground</code> repository and tags it <code>hello-docker</code>.</p>
<p>To see the image you have just created, run the following command.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">docker images
</code></pre></div><h3 id="run-the-docker-container">Run the Docker Container</h3><p>The following command will run the Docker container we just created.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">docker run -pt 8080:8080 &#34;playground:hello-docker&#34;
</code></pre></div><p>The <code>-t</code> and <code>&quot;playground:hello-docker&quot;</code> specifies the container to run.</p>
<p>By default, <code>http-server</code> uses <code>8080</code> as the port. In order to access it on our host machine we need to expose it.</p>
<p>The option <code>-p</code> and <code>8080:8080</code>  binds the host port to the container port. Here the first value is the container port and the other is the host port.</p>
<p>In order to test this we need to know the IP Address of the virtual machine which runs the container.</p>
<p>Run the following command to find the IP Address of your Docker virtual machine. It is under the URL column and looks like <code>tcp://&lt;virtualmachine_ipaddress&gt;:&lt;port&gt;</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">docker-machine ls
</code></pre></div><p>If everything went well you can see your <code>index.html</code> in the browser of your host machine using the following url.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">http://&lt;virtualmachine_ipaddress&gt;:8080/index.html
</code></pre></div><h3 id="some-useful-docker-commands">Some useful Docker commands</h3><p><strong>List all Images</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">docker images  
</code></pre></div><p><strong>List all Containers</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">docker ps -a
</code></pre></div><p><strong>Delete an Image</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">docker rmi &lt;imageid&gt;
</code></pre></div><p><strong>Delete a Container</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">docker rm &lt;containerid&gt;
</code></pre></div>
    </div>
</article>

<aside>
    <nav>
        <ul>
            
            <li>
                <a href="https://hemans.blog/posts/2016/2016-05-11-settingup-docker-windows-chocolatey/">&#8592; Setting up Docker on Windows using Chocolatey</a>
            </li>
            
            
            <li>
                <a href="https://hemans.blog/posts/2016/2016-05-17-universal-desktop-app-using-web-technologies/">Universal Desktop Apps using Web technologies &#8594;</a>
            </li>
            
        </ul>
    </nav>
</aside>


        </main>

        
            <div class="profile">
    <img src="/images/profile-picture.jpg"/>
    <p>
        Personal blog of <strong>Hemanshu Bhojak</strong> aka <strong>heman</strong>.
        I write what I learn.
    </p>
</div>
        
    </div>

</body>

</html>